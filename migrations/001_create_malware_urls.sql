CREATE TABLE IF NOT EXISTS malware_urls (
    id SERIAL PRIMARY KEY,
    hostname_and_port TEXT NOT NULL,
    path TEXT NOT NULL,
    query_string TEXT,   -- nullable
    UNIQUE (hostname_and_port, path, query_string)
);

INSERT INTO malware_urls (hostname_and_port, path, query_string) VALUES
('bad.com', '/malware', NULL),
('bad.com', '/malware', 'user=123'),
('bad.com', '/malware', 'session=abc'),
('evil.com', '/phish', NULL),
('evil.com', '/phish', 'redirect=login'),
('evil.com', '/phish', 'campaign=spring'),
('notsecure.com', '/attack', NULL),
('notsecure.com', '/attack', 'session=abc'),
('notsecure.com', '/attack', 'debug=true'),
('notsoftserver.com', '/hack', NULL),
('notsoftserver.com', '/hack', 'ref=campaign'),
('notsoftserver.com', '/hack', 'utm_source=newsletter'),
('malware.test', '/virus', NULL),
('malware.test', '/virus', 'download=true'),
('malware.test', '/virus', 'source=api'),
('bad.com:8080', '/malware', NULL),
('api.evil.com', '/phish', NULL),
('cdn.notsecure.com', '/attack', 'file=payload.exe')
ON CONFLICT DO NOTHING;
